(function(window){ var document = window.document; var root=document.documentElement,INVALID_HEIGHT_ERROR_MESSAGE="Invalid data-ustudio-height attribute.",INVALID_WIDTH_ERROR_MESSAGE="Invalid data-ustudio-width attribute.",MODULE_NAME="wrapper",extractData=function(a,b){return a.getAttribute("data-ustudio-"+b)},getLastScriptTagOnPage=function(){var a;a=document.getElementsByTagName("script");var b=a.length-1;if(0>b)return null;a=a[b];return!a.hasAttribute("data-ustudio-player-embed-url")||a.hasAttribute("data-ustudio-loaded")?null:a},run=function(){var a=
getLastScriptTagOnPage(),b,c,d;if(!a)return root.hasAttribute("data-ustudio-override")&&_attachEventListeners(window),null;b=extractData(a,"player-embed-url");c=_extractValidIntOrDie(a,"video-height",INVALID_HEIGHT_ERROR_MESSAGE);d=_extractValidIntOrDie(a,"video-width",INVALID_WIDTH_ERROR_MESSAGE);b=_attachFrame(b,c,d,a);_attachEventListeners(window);extractData(a,"enable-share")&&_attachShare("http://app.ustudio.com/static/api/js/player/sharing_widget.js",b);a.setAttribute("data-ustudio-loaded",
"true");return a},uStudioPlayerWidget=function(){var a;try{a=run()}catch(b){return b instanceof RequiredArgumentError?_writeErrorMessage(b.message):_writeErrorMessage("There was an error loading the player. "+b.message),null}return a},RequiredArgumentError=function(a){this.message=a},_createFrame=function(a,b,c){var d=document.createElement("iframe");d.src=a;d.setAttribute("scrolling","no");d.setAttribute("webkitAllowFullScreen","true");d.setAttribute("mozallowfullscreen","true");d.setAttribute("allowFullScreen",
"true");d.setAttribute("frameborder","0");d.setAttribute("height",b);d.setAttribute("width",c);return d},_attachFrame=function(a,b,c,d){return d.parentNode.insertBefore(_createFrame(a,b,c),d.nextSibling)},_writeErrorMessage=function(a){var b;console&&console.log&&console.log(a);b=document.createElement("div");b.id="ustudio-player-widget-error";b.textContent=a;a=document.createElement("div");a.appendChild(b);document.write(a.innerHTML)},_extractValidIntOrDie=function(a,b,c){a=parseInt(extractData(a,
b),10);if(isNaN(a)||0>=a)throw new RequiredArgumentError(c);return a},_createShare=function(a){var b=document.createElement("script");b.src=a;b.type="text/javascript";b.setAttribute("data-ustudio-share",!0);b.setAttribute("async",!0);return b},_attachShare=function(a,b){b.parentNode.insertBefore(_createShare(a),b.nextSibling)},_slice=Array.prototype.slice,_broadcast=function(a,b,c){a.postMessage(JSON.stringify({event:c,arguments:_slice.call(arguments,3)}),b||"*")},NAMESPACED_CLASS="ustudio-fullscreen",
reNamespacedClass=/\s?ustudio-fullscreen(\s|$)/,stylesheetId="ustudio-stylesheet",EVENT_MAP={"uStudio.eventsReady":function(a,b){_broadcast(b.source,b.origin,"uStudio.pageReady",{url:location.href,id:"id-here"})},start:function(a,b){_broadcast(b.source,b.origin,"fullscreen-capable",{source:MODULE_NAME,weight:1})},"fullscreen-off":function(a,b){a.arguments&&a.arguments[0].source==MODULE_NAME&&changeIframeClass(b.source,"")&&(root.classList&&root.classList.remove?root.classList.remove(NAMESPACED_CLASS):
root.className=root.className.replace(reNamespacedClass,""),_broadcast(b.source,b.origin,"fullscreen-change",{state:!1}))},"fullscreen-on":function(){return function(a,b){if(a.arguments&&a.arguments[0].source==MODULE_NAME){var c=document.getElementById(stylesheetId);changeIframeClass(b.source,"fullscreen-element")&&(root.classList&&root.classList.add?root.classList.add(NAMESPACED_CLASS):root.className+=" "+NAMESPACED_CLASS,c||(c=document.createElement("style"),c.setAttribute("type","text/css"),c.id=
stylesheetId,c.styleSheet?c.styleSheet.cssText=".ustudio-fullscreen iframe, .ustudio-fullscreen object, .ustudio-fullscreen embed { visibility: hidden; } .ustudio-fullscreen .fullscreen-element { position: fixed; top: 0; bottom: 0; left: 0; right: 0; visibility: visible; width: 100%; height: 100%; border: 0; }":c.appendChild(document.createTextNode(".ustudio-fullscreen iframe, .ustudio-fullscreen object, .ustudio-fullscreen embed { visibility: hidden; } .ustudio-fullscreen .fullscreen-element { position: fixed; top: 0; bottom: 0; left: 0; right: 0; visibility: visible; width: 100%; height: 100%; border: 0; }")),
(document.head||document.body).appendChild(c)),_broadcast(b.source,b.origin,"fullscreen-change",{state:!0}))}}}()},changeIframeClass=function(){var a;return function(b,c){a&&(a.className="");for(var d=document.getElementsByTagName("iframe"),f=0,e;e=d[f++];)if(e.contentWindow==b)return(e.className=c)&&(a=e),!0;return!1}}(),_messageListener=function(a){a=a||window.event;var b=JSON.parse(a.data),c=b.event&&EVENT_MAP[b.event];c&&c(b,a)},_attachEventListeners=function(a){!root.hasAttribute("data-ustudio-attached")&&
a.postMessage&&(a.addEventListener?a.addEventListener("message",_messageListener,!1):a.attachEvent&&a.attachEvent("onmessage",_messageListener))},_unattachEventListeners=function(a){a.removeEventListener?a.removeEventListener("message",_messageListener,!1):a.detachEvent&&a.detachEvent("onmessage",_messageListener)};; uStudioPlayerWidget();})(this);
