(function(e){var d=function(b,c,a){this._document=b;this._eventBus=c;this._configuration=a;this._id=a.id;this._controls="";this._muted=!1;this._duration=0};d.prototype.log=function(){};d.prototype.createControlElement=function(b){this._id=b;this._controls=this._document.createElement("div");this._controls.id=b;this._controls.className="ustudiocontrols";this.addEventListeners();var c=this;$("#playbutton").bind("click",function(){c.play()});$("#pausebutton").bind("click",function(){c.pause()});$("#mutebutton").bind("click",
function(){c.togglemute()});$("#seekbutton").bind("click",function(a){c.seek(a,10)});$("#volumeslider").bind("change",function(a){a=parseInt(a.target.value,10);$("#volumedisplay").text(a);c.volume(a/100)});this._eventBus.subscribe("Player.timeupdate",function(a){if(!isNaN(a.currentTime)){var b=c.prettyTime(a.currentTime);$("#playhead_time").text(b);a=c.runningTime=a.currentTime;$("#seeker").width(100*(a/c._duration)+"%")}});this._eventBus.subscribe("Player.durationchange",function(a){c._duration=
a.duration});$("#progressbar").bind("click",function(a){var b=$("#progressbar").width();c._eventBus.broadcast("Player.seekto",[{value:c._duration*(a.offsetX/b)}])});return this._controls};d.prototype.addEventListeners=function(){var b=this;this._eventBus.subscribe("Player.play",function(){b.log("Controls started playing")})};d.prototype.togglemute=function(){this._eventBus.broadcast("Player.mute");var b=(this._muted=!this._muted)?"btn btn-warning":"btn btn-inverse";$("#mutebutton").attr("class",b)};
d.prototype.play=function(){this._eventBus.broadcast("Player.play");$("#playbutton").addClass("disabled");$("#pausebutton").attr("class","btn btn-inverse");$("#playbutton").off()};d.prototype.pause=function(){this._eventBus.broadcast("Player.pause");$("#playbutton").on("onclick",this.play);$("#playbutton").removeClass("disabled");$("#pausebutton").attr("class","btn btn-warning")};d.prototype.seek=function(b,c){this._eventBus.broadcast("Player.seek",[{value:c}])};d.prototype.volume=function(b){this._eventBus.broadcast("Player.changeVolume",
[{level:b}])};d.prototype.prettyTime=function(b){b=new Date(b);var c=parseInt(b/3600,10)%24,a=parseInt(b/60,10)%60;seconds=b%60;return result=(10>c?"0"+c:c)+":"+(10>a?"0"+a:a)+":"+(10>seconds?"0"+seconds:seconds)};d.prototype.onStart=function(){this.log("Controls::onStart");var b=this.createControlElement(this._id);this._document.getElementById("controls").appendChild(b)};e.uStudio=e.uStudio||{};e.uStudio.Controls=d;uStudioCore.instance.registerModule("uStudioControls",function(b,c){var a=new d(document,
c,b);c.subscribe("start",a.onStart,a)})})(this);
