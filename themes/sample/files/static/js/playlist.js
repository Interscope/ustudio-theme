(function(d){var c=function(b,a,c,d){this._document=b;this._eventBus=a;this._configuration=c;this._playlist=d;this._startIndex=this._currentIndex=0;this._loopPlayback=this._configuration.loop_playback||!1;this._eventBus.subscribe("Playlist.selectVideo",this.selectVideo,this);this._eventBus.subscribe("Playlist.nextVideo",this.nextVideo,this);this._eventBus.subscribe("Playlist.previousVideo",this.previousVideo,this);this._eventBus.subscribe("Player.ended",this.videoEnded,this);this._eventBus.subscribe("start",
this._onStart,this);this.log=function(a){console.log(a)}};c.prototype._onStart=function(){this.selectVideo({index:this._currentIndex})};c.prototype.getVideo=function(){return this._playlist[this._currentIndex]};c.prototype.selectVideo=function(b){var a;this._currentIndex=b.index;if(a=this.getVideo())a.index=b.index,this._eventBus.broadcast("Playlist.videoSelected",[{video:a}])};c.prototype.nextVideo=function(b){var a=this._currentIndex+1;a>=this._playlist.length&&(a=0);return void 0==b||b||a!=this._startIndex?
(this.selectVideo({index:a}),!0):!1};c.prototype.previousVideo=function(b){var a=this._currentIndex-1;0>a&&(a=this._playlist.length-1);return void 0==b||b||a!=this._startIndex?(this.selectVideo({index:a}),!0):!1};c.prototype.videoEnded=function(){this.nextVideo(this._loopPlayback)||(this._eventBus.broadcast("Playlist.ended"),this.selectVideo({index:this._startIndex}))};c.prototype.onStart=function(){};d.uStudio=d.uStudio||{};d.uStudio.Playlist=c;uStudio.uStudioCore.instance.registerModule({name:"uStudioPlaylist",
initialize:function(b,a,d,e){b=new c(document,a,b,d);a.subscribe("start",b.onStart,b);e()}})})(this);
